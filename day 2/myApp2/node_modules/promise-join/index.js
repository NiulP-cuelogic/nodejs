const join = (obj) => new Promise((resolve) => {
  const result = {}
  const errors = {}
  const promises = Object.keys(obj).length
  let fulfilled = 0

  if (promises == 0) {
    resolve({result, errors})
  } else {
    Object.keys(obj).forEach((key) => {
      obj[key].then((val) => {
        result[key] = val
        fulfilled++
        if (fulfilled == promises)
          resolve({result, errors})
      }, (err) => {
        errors[key] = err
        fulfilled++
        if (fulfilled == promises)
          resolve({result, errors})
      })
    })
  }
})

module.exports = join
